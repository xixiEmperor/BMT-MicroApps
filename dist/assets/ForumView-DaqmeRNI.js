import{aI as a,u as e,r as l,o as t,L as s,l as o,h as i,g as n,w as p,m as r,af as m,ap as u,j as d,at as c,a3 as f,a as b,J as h,A as v,P as w,Q as _,f as g,as as j,au as y,k as V,p as k,aJ as x,x as z,E as C}from"./index-RXELqIC3.js";/* empty css                      *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                 *//* empty css                        *//* empty css                    */import"./el-tooltip-l0sNRNKZ.js";/* empty css                    */import{_ as D}from"./_plugin-vue_export-helper-CRLhVpGU.js";import{g as T}from"./forum-wY4xwZu6.js";import{u as U}from"./forum-Bu4C3K8F.js";import{f as A}from"./format-Be2yr7zd.js";const I={class:"forum-container"},J={class:"forum-actions"},L={class:"forum-content"},P={class:"topics-container"},Q=["onClick"],R={class:"topic-author"},S={class:"topic-stats"},E={class:"topic-last-reply"},F={class:"pagination-container"},G=D(a({l:"ForumView",setup(a){const D=b(),G=e(),K=U(),M=l([{name:"all",label:"全部帖子"},{name:"team",label:"打球组队"},{name:"notice",label:"赛事讨论"},{name:"help",label:"求助问答"},{name:"exp",label:"经验交流"}]),$=l("all"),q=l("");let B=null;const H=l(1),N=l(5),O=l(0),W=async()=>{const a=await T({page:H.value,pageSize:N.value,keyword:q.value,category:$.value});if(0===a.data.code){const e=a.data.data.list.map(a=>({...a,publishTime:A(a.publishTime),lastReply:A(a.lastReply)}));e.sort((a,e)=>a.isTop&&!e.isTop?-1:!a.isTop&&e.isTop?1:a.isTop&&e.isTop?new Date(e.topTime||e.publishTime).getTime()-new Date(a.topTime||a.publishTime).getTime():new Date(e.publishTime).getTime()-new Date(a.publishTime).getTime()),K.setPosts(e),O.value=a.data.data.total}};t(async()=>{await W()});const X=()=>{if(!G.token)return C.warning("请先登录后再发布文章"),void D.push("/login");D.push("/publish-post")},Y=()=>{B&&clearTimeout(B),B=setTimeout(()=>{H.value=1,W()},500)},Z=a=>{H.value=a,W()},aa=a=>{N.value=a,H.value=1,W()};s($,()=>{H.value=1,W()}),s(q,()=>{Y()});const ea=({row:a})=>a.isTop?"top-row":"";return(a,e)=>{const l=r,t=m,s=j,b=u,C=k,T=y,U=c,A=f;return h(),o("div",I,[e[5]||(e[5]=i("h2",null,"羽你同行论坛",-1)),i("div",J,[n(l,{type:"primary",onClick:X},{default:p(()=>[...e[3]||(e[3]=[v("发布新帖",-1)])]),t:1}),n(t,{modelValue:q.value,"onUpdate:modelValue":e[0]||(e[0]=a=>q.value=a),placeholder:"搜索论坛内容",class:"search-input"},{append:p(()=>[n(l,{onClick:Y},{default:p(()=>[...e[4]||(e[4]=[v("搜索",-1)])]),t:1})]),t:1},8,["modelValue"])]),i("div",L,[n(b,{modelValue:$.value,"onUpdate:modelValue":e[1]||(e[1]=a=>$.value=a),class:"demo-tabs"},{default:p(()=>[(h(!0),o(w,null,_(M.value,a=>(h(),g(s,{key:a.name,label:a.label,name:a.name},null,8,["label","name"]))),128))]),t:1},8,["modelValue"]),i("div",P,[n(U,{data:d(K).posts,style:{width:"100%"},"row-class-name":ea},{default:p(()=>[n(T,{prop:"title",label:"主题","min-width":"300"},{default:p(a=>[i("div",{class:"topic-title",onClick:e=>{return l=a.row.id,void D.push(`/post/${l}`);var l}},[a.row.isTop?(h(),g(C,{key:0,class:"top-icon"},{default:p(()=>[n(d(x))]),t:1})):V("",!0),v(" "+z(a.row.title),1)],8,Q)]),t:1}),n(T,{prop:"author",label:"作者",width:"120"},{default:p(a=>[i("div",R,z(a.row.author),1)]),t:1}),n(T,{prop:"replies",label:"回复/查看",width:"120"},{default:p(a=>[i("div",S,[i("div",null,z(a.row.replyCount||0)+" 回复",1),i("div",null,z(a.row.views)+" 查看",1)])]),t:1}),n(T,{prop:"lastReply",label:"最后回复",width:"120"},{default:p(a=>[i("div",E,z(a.row.lastReply),1)]),t:1})]),t:1},8,["data"])]),i("div",F,[n(A,{modelValue:H.value,"onUpdate:modelValue":e[2]||(e[2]=a=>H.value=a),"page-size":N.value,total:O.value,"page-sizes":[5,8,10,15],layout:"total, sizes, prev, pager, next",onSizeChange:aa,onCurrentChange:Z},null,8,["modelValue","page-size","total"])])])])}}}),[["__scopeId","data-v-a7125a8d"]]);export{G as default};
