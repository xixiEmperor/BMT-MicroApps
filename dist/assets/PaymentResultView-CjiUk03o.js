import{d as a,a as s}from"./index-BuScbc3L.js";/* empty css                         */import{_ as e}from"./_plugin-vue_export-helper-CTKw_zaB.js";import{r as l,q as t,E as i,N as c,K as n,B as u,A as o,Q as r,M as d,V as v,O as p,ax as m,z as f,u as y,aP as _,Y as k,aQ as g,aR as h,aS as b}from"./element-plus-D8DMz00a.js";import{g as C,q as w}from"./pay-D_1k_pGE.js";const z={class:"payment-result-container"},j={key:0,class:"result-content success"},q={class:"result-icon"},x={class:"order-info"},N={class:"info-item"},S={class:"value"},A={key:0,class:"info-item"},I={class:"value price"},L={key:1,class:"info-item"},M={class:"value"},O={class:"action-buttons"},P={key:1,class:"result-content failed"},Q={class:"result-icon"},R={class:"order-info"},T={class:"info-item"},V={class:"value"},B={class:"info-item"},D={class:"value"},E={class:"action-buttons"},F={key:2,class:"result-content timeout"},J={class:"result-icon"},K={class:"order-info"},Y={class:"info-item"},$={class:"value"},G={class:"action-buttons"},H={key:3,class:"result-content cancelled"},U={class:"result-icon"},W={class:"order-info"},X={class:"info-item"},Z={class:"value"},aa={class:"action-buttons"},sa={key:4,class:"result-content loading"},ea=e({__name:"PaymentResultView",setup(e){const ea=s(),la=a(),ta=l(""),ia=l(""),ca=l(null),na=l(""),viewOrderDetail=()=>{ea.push(`/order-detail/${ia.value}`)},continueShopping=()=>{ea.push("/shop")},retryPayment=()=>{var a;const s={orderNo:ia.value,amount:(null==(a=ca.value)?void 0:a.totalAmount)||0,businessType:"MALL"};localStorage.setItem("payment_info",JSON.stringify(s)),ea.push("/payment")},formatTime=a=>{if(!a)return"";return new Date(a).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})};return t(async()=>{if(ia.value=la.query.orderNo,ta.value=la.query.status||"",!ia.value)return i.error("订单号不存在"),void ea.push("/orders");await(async()=>{try{const a=await C(ia.value);0===a.data.code&&(ca.value=a.data.data)}catch(a){}})(),ta.value&&"unknown"!==ta.value||await(async()=>{try{const a=await w(ia.value);if(0===a.data.code){const s=a.data.data.status;ta.value=1===s?"success":la.query.status||"failed"}else ta.value="failed",na.value=a.message}catch(a){ta.value="failed",na.value="网络异常，请稍后重试"}})(),localStorage.removeItem("payment_info")}),(a,s)=>{var e;const l=r,t=p,i=m;return f(),c("div",z,["success"===ta.value?(f(),c("div",j,[n("div",q,[u(l,{class:"success-icon",size:"80"},{default:o(()=>[u(y(_))]),_:1})]),s[5]||(s[5]=n("h2",{class:"result-title"},"支付成功",-1)),s[6]||(s[6]=n("p",{class:"result-message"},"恭喜您，订单支付成功！",-1)),n("div",x,[n("div",N,[s[0]||(s[0]=n("span",{class:"label"},"订单号：",-1)),n("span",S,v(ia.value),1)]),ca.value?(f(),c("div",A,[s[1]||(s[1]=n("span",{class:"label"},"支付金额：",-1)),n("span",I,"¥"+v(null==(e=ca.value.totalAmount)?void 0:e.toFixed(2)),1)])):d("",!0),ca.value?(f(),c("div",L,[s[2]||(s[2]=n("span",{class:"label"},"支付时间：",-1)),n("span",M,v(formatTime(ca.value.payTime)),1)])):d("",!0)]),n("div",O,[u(t,{type:"primary",onClick:viewOrderDetail},{default:o(()=>[...s[3]||(s[3]=[k("查看订单详情",-1)])]),_:1}),u(t,{onClick:continueShopping},{default:o(()=>[...s[4]||(s[4]=[k("继续购物",-1)])]),_:1})])])):"failed"===ta.value?(f(),c("div",P,[n("div",Q,[u(l,{class:"failed-icon",size:"80"},{default:o(()=>[u(y(g))]),_:1})]),s[12]||(s[12]=n("h2",{class:"result-title"},"支付失败",-1)),s[13]||(s[13]=n("p",{class:"result-message"},"很抱歉，您的订单支付失败，请重试",-1)),n("div",R,[n("div",T,[s[7]||(s[7]=n("span",{class:"label"},"订单号：",-1)),n("span",V,v(ia.value),1)]),n("div",B,[s[8]||(s[8]=n("span",{class:"label"},"失败原因：",-1)),n("span",D,v(na.value||"支付过程中出现异常"),1)])]),n("div",E,[u(t,{type:"primary",onClick:retryPayment},{default:o(()=>[...s[9]||(s[9]=[k("重新支付",-1)])]),_:1}),u(t,{onClick:viewOrderDetail},{default:o(()=>[...s[10]||(s[10]=[k("查看订单详情",-1)])]),_:1}),u(t,{onClick:continueShopping},{default:o(()=>[...s[11]||(s[11]=[k("继续购物",-1)])]),_:1})])])):"timeout"===ta.value?(f(),c("div",F,[n("div",J,[u(l,{class:"timeout-icon",size:"80"},{default:o(()=>[u(y(h))]),_:1})]),s[19]||(s[19]=n("h2",{class:"result-title"},"支付超时",-1)),s[20]||(s[20]=n("p",{class:"result-message"},"支付时间已超时，请重新发起支付",-1)),n("div",K,[n("div",Y,[s[14]||(s[14]=n("span",{class:"label"},"订单号：",-1)),n("span",$,v(ia.value),1)]),s[15]||(s[15]=n("div",{class:"info-item"},[n("span",{class:"label"},"超时时间："),n("span",{class:"value"},"10分钟")],-1))]),n("div",G,[u(t,{type:"primary",onClick:retryPayment},{default:o(()=>[...s[16]||(s[16]=[k("重新支付",-1)])]),_:1}),u(t,{onClick:viewOrderDetail},{default:o(()=>[...s[17]||(s[17]=[k("查看订单详情",-1)])]),_:1}),u(t,{onClick:continueShopping},{default:o(()=>[...s[18]||(s[18]=[k("继续购物",-1)])]),_:1})])])):"cancelled"===ta.value?(f(),c("div",H,[n("div",U,[u(l,{class:"cancelled-icon",size:"80"},{default:o(()=>[u(y(b))]),_:1})]),s[25]||(s[25]=n("h2",{class:"result-title"},"支付已取消",-1)),s[26]||(s[26]=n("p",{class:"result-message"},"您已取消本次支付，可以重新发起支付",-1)),n("div",W,[n("div",X,[s[21]||(s[21]=n("span",{class:"label"},"订单号：",-1)),n("span",Z,v(ia.value),1)])]),n("div",aa,[u(t,{type:"primary",onClick:retryPayment},{default:o(()=>[...s[22]||(s[22]=[k("重新支付",-1)])]),_:1}),u(t,{onClick:viewOrderDetail},{default:o(()=>[...s[23]||(s[23]=[k("查看订单详情",-1)])]),_:1}),u(t,{onClick:continueShopping},{default:o(()=>[...s[24]||(s[24]=[k("继续购物",-1)])]),_:1})])])):(f(),c("div",sa,[u(i,{rows:5,animated:""})]))])}}},[["__scopeId","data-v-ae46554b"]]);export{ea as default};
