import{r as a,o as e,l as t,h as s,g as r,w as l,C as o,A as c,P as i,Q as d,B as n,O as u,a4 as p,J as m,f as g,x as y,K as v,d as f,L as h,M as _,k as C,ae as b,a0 as w,$ as k,af as F,R as I,m as S,ah as j,a1 as x,aj as A,a2 as E,a3 as z,E as N,a as B,ak as D,U as $,a6 as M,al as V,a7 as L,aa as P,b as U,I as J,am as T,G as K}from"./index-BtPdgGUc.js";/* empty css                     *//* empty css               */import"./el-tooltip-l0sNRNKZ.js";/* empty css                     */import{g as O,a as W,b as G}from"./shop-CJgBMkVS.js";import{_ as H}from"./_plugin-vue_export-helper-CTKw_zaB.js";/* empty css                   *//* empty css                      *//* empty css                  *//* empty css                 *//* empty css                 *//* empty css               *//* empty css                *//* empty css                     *//* empty css                         */const Q={class:"category-list"},R={class:"mobile-categories"},q={class:"category-tags"},X=H({__name:"CategoryList",emits:["category-selected"],setup(v,{emit:f}){const h=a([]),_=a("all"),handleCategorySelect=a=>{_.value=a,C("category-selected",a)},C=f;return e(()=>{(async()=>{const a=await O();h.value=a.data.data})()}),(a,e)=>{const v=o,f=n,C=p;return m(),t("div",Q,[e[3]||(e[3]=s("h2",null,"商品分类",-1)),r(f,{class:"category-menu desktop-menu","default-active":_.value,onSelect:handleCategorySelect},{default:l(()=>[r(v,{index:"all"},{default:l(()=>[...e[1]||(e[1]=[c(" 全部商品 ",-1)])]),_:1}),(m(!0),t(i,null,d(h.value,a=>(m(),g(v,{key:a.id,index:a.id.toString()},{default:l(()=>[c(y(a.name),1)]),_:2},1032,["index"]))),128))]),_:1},8,["default-active"]),s("div",R,[s("div",q,[r(C,{class:u(["category-tag",{active:"all"===_.value}]),onClick:e[0]||(e[0]=a=>handleCategorySelect("all")),effect:"plain"},{default:l(()=>[...e[2]||(e[2]=[c(" 全部商品 ",-1)])]),_:1},8,["class"]),(m(!0),t(i,null,d(h.value,a=>(m(),g(C,{key:a.id,class:u(["category-tag",{active:_.value===a.id.toString()}]),onClick:e=>handleCategorySelect(a.id.toString()),effect:"plain"},{default:l(()=>[c(y(a.name),1)]),_:2},1032,["class","onClick"]))),128))])])])}}},[["__scopeId","data-v-030a4f76"]]),Y={class:"product-list"},Z={class:"filter-panel"},aa={class:"filter-row"},ea={class:"button-row"},ta={class:"product-grid"},sa=["src"],ra={class:"product-info"},la={class:"product-name"},oa={class:"product-subtitle"},ca={class:"product-price-row"},ia={class:"product-price"},da={class:"product-sales"},na={key:0,class:"pagination-container"},ua=H({__name:"ProductList",props:{categoryId:{type:[String,Number],default:"all"}},setup(e){const o=e,n=B(),u=a(!1),p=a([]),M=v({keyword:"",orderBy:"",pageNum:1,pageSize:8,categoryId:o.categoryId}),V=v({pageNum:1,pageSize:8,total:0}),L=f(()=>window.innerWidth<=768?"prev, pager, next":"total, sizes, prev, pager, next, jumper"),fetchProducts=async()=>{u.value=!0;try{const a=await W(M);0===a.data.code?(p.value=a.data.data.list,V.pageNum=a.data.data.pageNum,V.pageSize=a.data.data.pageSize,V.total=a.data.data.total):N.error("获取商品列表失败")}catch(a){N.error("获取商品列表失败")}finally{u.value=!1}};h(()=>o.categoryId,a=>{M.categoryId=a,M.pageNum=1,fetchProducts()},{immediate:!0});const handleSearch=()=>{M.pageNum=1,fetchProducts()},resetSearch=()=>{M.keyword="",M.orderBy="",M.pageNum=1,fetchProducts()},handleSizeChange=a=>{M.pageSize=a,fetchProducts()},handleCurrentChange=a=>{M.pageNum=a,fetchProducts()};return(a,e)=>{const o=k,v=w,f=b,h=F,N=S,B=j,P=$,U=D,J=A,T=E,K=z,O=x;return m(),t("div",Y,[s("div",Z,[r(B,{inline:!0,class:"filter-form"},{default:l(()=>[s("div",aa,[r(f,{label:"排序方式",class:"sort-item"},{default:l(()=>[r(v,{modelValue:M.orderBy,"onUpdate:modelValue":e[0]||(e[0]=a=>M.orderBy=a),placeholder:"请选择"},{default:l(()=>[r(o,{label:"默认排序",value:""}),r(o,{label:"价格升序",value:"price_asc"}),r(o,{label:"价格降序",value:"price_desc"}),r(o,{label:"销量降序",value:"sales_desc"})]),_:1},8,["modelValue"])]),_:1}),r(f,{label:"关键词",class:"search-item"},{default:l(()=>[r(h,{modelValue:M.keyword,"onUpdate:modelValue":e[1]||(e[1]=a=>M.keyword=a),placeholder:"请输入关键词",onKeyup:I(handleSearch,["enter"])},null,8,["modelValue"])]),_:1})]),s("div",ea,[r(f,null,{default:l(()=>[r(N,{type:"primary",onClick:handleSearch},{default:l(()=>[...e[2]||(e[2]=[c("搜索",-1)])]),_:1}),r(N,{onClick:resetSearch},{default:l(()=>[...e[3]||(e[3]=[c("重置",-1)])]),_:1})]),_:1})])]),_:1})]),_((m(),t("div",ta,[r(J,{gutter:20},{default:l(()=>[(m(!0),t(i,null,d(p.value,a=>(m(),g(U,{xs:12,sm:12,md:8,lg:6,key:a.id},{default:l(()=>[r(P,{class:"product-card",onClick:e=>{return t=a.id,void n.push(`/product/${t}`);var t}},{default:l(()=>[s("img",{src:a.mainImage,class:"product-image"},null,8,sa),s("div",ra,[s("h3",la,y(a.name),1),s("p",oa,y(a.subtitle),1),s("div",ca,[s("span",ia,"¥"+y(a.price.toFixed(2)),1),s("span",da,"销量: "+y(a.sales),1)])])]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1}),0!==p.value.length||u.value?C("",!0):(m(),g(T,{key:0,description:"暂无商品"}))])),[[O,u.value]]),V.total>0?(m(),t("div",na,[r(K,{background:"",onSizeChange:handleSizeChange,onCurrentChange:handleCurrentChange,"current-page":V.pageNum,"page-sizes":[8,4,6,10,12],"page-size":V.pageSize,layout:L.value,total:V.total},null,8,["current-page","page-size","layout","total"])])):C("",!0)])}}},[["__scopeId","data-v-e932d64b"]]),pa={class:"product-carousel"},ma={class:"content-left"},ga={class:"carousel-title"},ya={class:"carousel-subtitle"},va={class:"content-right"},fa=["src","alt"],ha=H({__name:"ProductCarousel",setup(o){const n=B(),u=a([]);a([]);const p=[{primary:"#FF6B6B",secondary:"#4ECDC4"},{primary:"#845EC2",secondary:"#FF8066"},{primary:"#FFD93D",secondary:"#6BCF7F"},{primary:"#FF8E9B",secondary:"#C7CEEA"},{primary:"#A8E6CF",secondary:"#FFEAA7"},{primary:"#74B9FF",secondary:"#FD79A8"},{primary:"#FDCB6E",secondary:"#6C5CE7"},{primary:"#55A3FF",secondary:"#FEA47F"},{primary:"#26DE81",secondary:"#FC7C7C"},{primary:"#A29BFE",secondary:"#FDA085"}],getColorIndexFromString=a=>{let e=0;for(let t=0;t<a.length;t++){e=(e<<5)-e+a.charCodeAt(t),e&=e}return Math.abs(e)%p.length},getThemeColorViaProxy=async()=>{try{const a=u.value.map(async(a,e)=>{try{const e=await V.post("/api/image/extract-color",{imageUrl:a.mainImage});if(0===e.data.code){const t=e.data.data.color,s=e.data.data.source,r=`linear-gradient(135deg, ${t}CC, ${adjustColorBrightness(t,-30)}DD)`;return a.bgColor=r,a.colorSource="oss"===s?"阿里云OSS":"java"===s?"Java处理":s,{color:t,source:s,success:!0}}throw new Error(e.data.msg||"后端返回错误")}catch(t){const e=getColorIndexFromString(a.productName+a.productId),s=p[e],r=`linear-gradient(135deg, ${s.primary}CC, ${s.secondary}AA)`;return a.bgColor=r,a.colorSource="预设方案",{color:s.primary,source:"fallback",success:!1,error:t.message}}}),e=await Promise.all(a);e.filter(a=>a.success).length,e.filter(a=>!a.success).length}catch(a){await(async()=>{try{u.value.forEach((a,e)=>{const t=getColorIndexFromString(a.productName+a.productId),s=p[t],r=`linear-gradient(135deg, ${s.primary}CC, ${s.secondary}AA)`;a.bgColor=r})}catch(a){}})()}},adjustColorBrightness=(a,e)=>{const t=a.replace("#",""),s=parseInt(t,16);return"#"+((1<<24)+(Math.max(0,Math.min(255,(s>>16)+e))<<16)+(Math.max(0,Math.min(255,(s>>8&255)+e))<<8)+Math.max(0,Math.min(255,(255&s)+e))).toString(16).slice(1)};return e(async()=>{await(async()=>{try{const a=await G();0===a.data.code?u.value=a.data.data:N.error(a.data.msg)}catch(a){}})(),await getThemeColorViaProxy()}),(a,e)=>{const o=S,p=L,v=M;return m(),t("div",pa,[r(v,{interval:4e3,type:"card",height:"280px","indicator-position":"outside",arrow:"never",class:"carousel-container"},{default:l(()=>[(m(!0),t(i,null,d(u.value,a=>(m(),g(p,{key:a.productId,class:"carousel-item"},{default:l(()=>[s("div",{class:"carousel-content",style:P({background:a.bgColor||"linear-gradient(135deg, #6366f1AA, #4f46e5DD)"})},[s("div",ma,[s("h3",ga,y(a.productName),1),s("p",ya,y(a.subtitle),1),r(o,{type:"primary",size:"large",class:"carousel-button",onClick:e=>{return t=a.productId,void n.push(`/product/${t}`);var t}},{default:l(()=>[...e[0]||(e[0]=[c(" 立即购买 ",-1)])]),_:1},8,["onClick"])]),s("div",va,[s("img",{src:a.mainImage,alt:a.productName,class:"carousel-image"},null,8,fa)])],4)]),_:2},1024))),128))]),_:1})])}}},[["__scopeId","data-v-805635c4"]]),_a={class:"shop-container"},Ca={class:"category-section"},ba={key:1,class:"mobile-layout"},wa={class:"mobile-category"},ka={class:"mobile-products"},Fa=H({__name:"ShopView",setup(o){const c=a("all"),i=a(!1),checkScreenSize=()=>{i.value=window.innerWidth<=768},d=((a,e)=>{let t;return function(...s){clearTimeout(t),t=setTimeout(()=>{clearTimeout(t),a(...s)},e)}})(checkScreenSize,150),handleCategoryChange=a=>{c.value=a};return e(()=>{checkScreenSize(),window.addEventListener("resize",d)}),U(()=>{window.removeEventListener("resize",d)}),(a,e)=>{const o=T,d=K,n=J;return m(),t("div",_a,[e[0]||(e[0]=s("div",{class:"page-header"},[s("h1",{class:"page-title"},"羽体商城"),s("p",{class:"page-subtitle"},"专业羽毛球装备，助力你的运动表现")],-1)),r(ha),i.value?C("",!0):(m(),g(n,{key:0,class:"desktop-layout"},{default:l(()=>[r(o,{width:"240px",class:"sidebar"},{default:l(()=>[s("div",Ca,[r(X,{onCategorySelected:handleCategoryChange})])]),_:1}),r(d,{class:"main-content"},{default:l(()=>[r(ua,{categoryId:c.value},null,8,["categoryId"])]),_:1})]),_:1})),i.value?(m(),t("div",ba,[s("div",wa,[r(X,{onCategorySelected:handleCategoryChange})]),s("div",ka,[r(ua,{categoryId:c.value},null,8,["categoryId"])])])):C("",!0)])}}},[["__scopeId","data-v-973c1984"]]);export{Fa as default};
