import{aI as M,u as $,r as u,o as j,L as C,l as V,h as l,g as s,w as n,m as A,af as K,ap as Q,j as k,at as q,a3 as G,a as H,J as v,A as T,P as O,Q as W,f as E,as as X,au as Y,k as Z,p as ee,aJ as te,x as m,E as ae}from"./index-C7uw_EaC.js";/* empty css                      *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                 *//* empty css                        *//* empty css                    */import"./el-tooltip-l0sNRNKZ.js";/* empty css                    */import{_ as oe}from"./_plugin-vue_export-helper-DedD7E0N.js";import{g as le}from"./forum-D803p2CR.js";import{u as se}from"./forum-DJCDhZSe.js";import{f as S}from"./format-BoKD-3ja.js";const ne={class:"forum-container"},ie={class:"forum-actions"},re={class:"forum-content"},ue={class:"topics-container"},pe=["onClick"],me={class:"topic-author"},ce={class:"topic-stats"},de={class:"topic-last-reply"},_e={class:"pagination-container"},ve=M({__name:"ForumView",setup(fe){const f=H(),x=$(),w=se(),z=u([{name:"all",label:"全部帖子"},{name:"team",label:"打球组队"},{name:"notice",label:"赛事讨论"},{name:"help",label:"求助问答"},{name:"exp",label:"经验交流"}]),c=u("all"),d=u("");let h=null;const r=u(1),g=u(5),b=u(0),p=async()=>{const a=await le({page:r.value,pageSize:g.value,keyword:d.value,category:c.value});if(a.data.code===0){console.log(a);const t=a.data.data.list.map(o=>({...o,publishTime:S(o.publishTime),lastReply:S(o.lastReply)}));t.sort((o,i)=>o.isTop&&!i.isTop?-1:!o.isTop&&i.isTop?1:o.isTop&&i.isTop?new Date(i.topTime||i.publishTime).getTime()-new Date(o.topTime||o.publishTime).getTime():new Date(i.publishTime).getTime()-new Date(o.publishTime).getTime()),w.setPosts(t),b.value=a.data.data.total}};j(async()=>{await p()});const D=()=>{if(!x.token){ae.warning("请先登录后再发布文章"),f.push("/login");return}f.push("/publish-post")},P=a=>{f.push(`/post/${a}`)},y=()=>{h&&clearTimeout(h),h=setTimeout(()=>{r.value=1,p()},500)},F=a=>{r.value=a,p()},R=a=>{g.value=a,r.value=1,p()};C(c,()=>{r.value=1,p()}),C(d,()=>{y()});const B=({row:a})=>a.isTop?"top-row":"";return(a,t)=>{const o=A,i=K,L=X,N=Q,I=ee,_=Y,U=q,J=G;return v(),V("div",ne,[t[5]||(t[5]=l("h2",null,"羽你同行论坛",-1)),l("div",ie,[s(o,{type:"primary",onClick:D},{default:n(()=>[...t[3]||(t[3]=[T("发布新帖",-1)])]),_:1}),s(i,{modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=e=>d.value=e),placeholder:"搜索论坛内容",class:"search-input"},{append:n(()=>[s(o,{onClick:y},{default:n(()=>[...t[4]||(t[4]=[T("搜索",-1)])]),_:1})]),_:1},8,["modelValue"])]),l("div",re,[s(N,{modelValue:c.value,"onUpdate:modelValue":t[1]||(t[1]=e=>c.value=e),class:"demo-tabs"},{default:n(()=>[(v(!0),V(O,null,W(z.value,e=>(v(),E(L,{key:e.name,label:e.label,name:e.name},null,8,["label","name"]))),128))]),_:1},8,["modelValue"]),l("div",ue,[s(U,{data:k(w).posts,style:{width:"100%"},"row-class-name":B},{default:n(()=>[s(_,{prop:"title",label:"主题","min-width":"300"},{default:n(e=>[l("div",{class:"topic-title",onClick:he=>P(e.row.id)},[e.row.isTop?(v(),E(I,{key:0,class:"top-icon"},{default:n(()=>[s(k(te))]),_:1})):Z("",!0),T(" "+m(e.row.title),1)],8,pe)]),_:1}),s(_,{prop:"author",label:"作者",width:"120"},{default:n(e=>[l("div",me,m(e.row.author),1)]),_:1}),s(_,{prop:"replies",label:"回复/查看",width:"120"},{default:n(e=>[l("div",ce,[l("div",null,m(e.row.replyCount||0)+" 回复",1),l("div",null,m(e.row.views)+" 查看",1)])]),_:1}),s(_,{prop:"lastReply",label:"最后回复",width:"120"},{default:n(e=>[l("div",de,m(e.row.lastReply),1)]),_:1})]),_:1},8,["data"])]),l("div",_e,[s(J,{modelValue:r.value,"onUpdate:modelValue":t[2]||(t[2]=e=>r.value=e),"page-size":g.value,total:b.value,"page-sizes":[5,8,10,15],layout:"total, sizes, prev, pager, next",onSizeChange:R,onCurrentChange:F},null,8,["modelValue","page-size","total"])])])])}}}),Fe=oe(ve,[["__scopeId","data-v-a7125a8d"]]);export{Fe as default};
