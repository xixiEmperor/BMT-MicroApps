import{r as a,o as s,an as e,E as l,a as t,l as i,h as c,g as n,w as u,p as o,k as d,x as r,m as v,ai as p,J as m,j as f,aE as y,A as _,aF as k,aG as g,aH as h}from"./index-BMm2wflY.js";/* empty css                         */import{_ as b}from"./_plugin-vue_export-helper-CTKw_zaB.js";import{g as C,q as w}from"./pay-CLrLKGCg.js";const j={class:"payment-result-container"},x={key:0,class:"result-content success"},z={class:"result-icon"},N={class:"order-info"},q={class:"info-item"},A={class:"value"},S={key:0,class:"info-item"},I={class:"value price"},L={key:1,class:"info-item"},E={class:"value"},F={class:"action-buttons"},J={key:1,class:"result-content failed"},T={class:"result-icon"},D={class:"order-info"},G={class:"info-item"},H={class:"value"},M={class:"info-item"},O={class:"value"},P={class:"action-buttons"},R={key:2,class:"result-content timeout"},V={class:"result-icon"},$={class:"order-info"},B={class:"info-item"},K={class:"value"},Q={class:"action-buttons"},U={key:3,class:"result-content cancelled"},W={class:"result-icon"},X={class:"order-info"},Y={class:"info-item"},Z={class:"value"},aa={class:"action-buttons"},sa={key:4,class:"result-content loading"},ea=b({__name:"PaymentResultView",setup(b){const ea=t(),la=e(),ta=a(""),ia=a(""),ca=a(null),na=a(""),viewOrderDetail=()=>{ea.push(`/order-detail/${ia.value}`)},continueShopping=()=>{ea.push("/shop")},retryPayment=()=>{var a;const s={orderNo:ia.value,amount:(null==(a=ca.value)?void 0:a.totalAmount)||0,businessType:"MALL"};localStorage.setItem("payment_info",JSON.stringify(s)),ea.push("/payment")},formatTime=a=>{if(!a)return"";return new Date(a).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})};return s(async()=>{if(ia.value=la.query.orderNo,ta.value=la.query.status||"",!ia.value)return l.error("订单号不存在"),void ea.push("/orders");await(async()=>{try{const a=await C(ia.value);0===a.data.code&&(ca.value=a.data.data)}catch(a){}})(),ta.value&&"unknown"!==ta.value||await(async()=>{try{const a=await w(ia.value);if(0===a.data.code){const s=a.data.data.status;ta.value=1===s?"success":la.query.status||"failed"}else ta.value="failed",na.value=a.message}catch(a){ta.value="failed",na.value="网络异常，请稍后重试"}})(),localStorage.removeItem("payment_info")}),(a,s)=>{var e;const l=o,t=v,b=p;return m(),i("div",j,["success"===ta.value?(m(),i("div",x,[c("div",z,[n(l,{class:"success-icon",size:"80"},{default:u(()=>[n(f(y))]),_:1})]),s[5]||(s[5]=c("h2",{class:"result-title"},"支付成功",-1)),s[6]||(s[6]=c("p",{class:"result-message"},"恭喜您，订单支付成功！",-1)),c("div",N,[c("div",q,[s[0]||(s[0]=c("span",{class:"label"},"订单号：",-1)),c("span",A,r(ia.value),1)]),ca.value?(m(),i("div",S,[s[1]||(s[1]=c("span",{class:"label"},"支付金额：",-1)),c("span",I,"¥"+r(null==(e=ca.value.totalAmount)?void 0:e.toFixed(2)),1)])):d("",!0),ca.value?(m(),i("div",L,[s[2]||(s[2]=c("span",{class:"label"},"支付时间：",-1)),c("span",E,r(formatTime(ca.value.payTime)),1)])):d("",!0)]),c("div",F,[n(t,{type:"primary",onClick:viewOrderDetail},{default:u(()=>[...s[3]||(s[3]=[_("查看订单详情",-1)])]),_:1}),n(t,{onClick:continueShopping},{default:u(()=>[...s[4]||(s[4]=[_("继续购物",-1)])]),_:1})])])):"failed"===ta.value?(m(),i("div",J,[c("div",T,[n(l,{class:"failed-icon",size:"80"},{default:u(()=>[n(f(k))]),_:1})]),s[12]||(s[12]=c("h2",{class:"result-title"},"支付失败",-1)),s[13]||(s[13]=c("p",{class:"result-message"},"很抱歉，您的订单支付失败，请重试",-1)),c("div",D,[c("div",G,[s[7]||(s[7]=c("span",{class:"label"},"订单号：",-1)),c("span",H,r(ia.value),1)]),c("div",M,[s[8]||(s[8]=c("span",{class:"label"},"失败原因：",-1)),c("span",O,r(na.value||"支付过程中出现异常"),1)])]),c("div",P,[n(t,{type:"primary",onClick:retryPayment},{default:u(()=>[...s[9]||(s[9]=[_("重新支付",-1)])]),_:1}),n(t,{onClick:viewOrderDetail},{default:u(()=>[...s[10]||(s[10]=[_("查看订单详情",-1)])]),_:1}),n(t,{onClick:continueShopping},{default:u(()=>[...s[11]||(s[11]=[_("继续购物",-1)])]),_:1})])])):"timeout"===ta.value?(m(),i("div",R,[c("div",V,[n(l,{class:"timeout-icon",size:"80"},{default:u(()=>[n(f(g))]),_:1})]),s[19]||(s[19]=c("h2",{class:"result-title"},"支付超时",-1)),s[20]||(s[20]=c("p",{class:"result-message"},"支付时间已超时，请重新发起支付",-1)),c("div",$,[c("div",B,[s[14]||(s[14]=c("span",{class:"label"},"订单号：",-1)),c("span",K,r(ia.value),1)]),s[15]||(s[15]=c("div",{class:"info-item"},[c("span",{class:"label"},"超时时间："),c("span",{class:"value"},"10分钟")],-1))]),c("div",Q,[n(t,{type:"primary",onClick:retryPayment},{default:u(()=>[...s[16]||(s[16]=[_("重新支付",-1)])]),_:1}),n(t,{onClick:viewOrderDetail},{default:u(()=>[...s[17]||(s[17]=[_("查看订单详情",-1)])]),_:1}),n(t,{onClick:continueShopping},{default:u(()=>[...s[18]||(s[18]=[_("继续购物",-1)])]),_:1})])])):"cancelled"===ta.value?(m(),i("div",U,[c("div",W,[n(l,{class:"cancelled-icon",size:"80"},{default:u(()=>[n(f(h))]),_:1})]),s[25]||(s[25]=c("h2",{class:"result-title"},"支付已取消",-1)),s[26]||(s[26]=c("p",{class:"result-message"},"您已取消本次支付，可以重新发起支付",-1)),c("div",X,[c("div",Y,[s[21]||(s[21]=c("span",{class:"label"},"订单号：",-1)),c("span",Z,r(ia.value),1)])]),c("div",aa,[n(t,{type:"primary",onClick:retryPayment},{default:u(()=>[...s[22]||(s[22]=[_("重新支付",-1)])]),_:1}),n(t,{onClick:viewOrderDetail},{default:u(()=>[...s[23]||(s[23]=[_("查看订单详情",-1)])]),_:1}),n(t,{onClick:continueShopping},{default:u(()=>[...s[24]||(s[24]=[_("继续购物",-1)])]),_:1})])])):(m(),i("div",sa,[n(b,{rows:5,animated:""})]))])}}},[["__scopeId","data-v-ae46554b"]]);export{ea as default};
