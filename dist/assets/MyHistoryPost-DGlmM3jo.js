import{u as a,r as t,o as s,l as e,h as l,k as i,g as o,j as n,aS as r,x as p,A as c,w as d,m as u,M as m,a1 as v,f as y,p as f,aJ as h,au as g,a4 as j,aT as _,ay as b,a3 as k,E as w,a as C,c as x,at as z,J as A}from"./index-RXELqIC3.js";/* empty css                   *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                 *//* empty css                        *//* empty css                    */import"./el-tooltip-l0sNRNKZ.js";import{_ as M}from"./_plugin-vue_export-helper-CRLhVpGU.js";/* empty css                  */import{f as S}from"./format-Be2yr7zd.js";import{j as T,h as I}from"./forum-wY4xwZu6.js";/* empty css                       *//* empty css                   */const P={class:"my-posts-container"},V={class:"posts-header"},B={key:0,class:"user-info"},J={class:"username"},L={class:"user-stats"},$={class:"stat-item"},D={class:"posts-content"},E=["onClick"],F={class:"post-stats"},G={class:"post-actions"},H={class:"pagination-container"},O=M({t:"MyHistoryPost",setup(M){const O=C(),R=a();t({}).value=R.userinfo||{};const U=t(1),q=t(10),K=t(0),N=t([]),Q=t(!1),W=async()=>{var a;if(!(null==(a=R.userinfo)?void 0:a.id))return w.warning("请先登录"),void O.push("/login");Q.value=!0;try{const a={userId:R.userinfo.id,page:U.value,pageSize:q.value},t=await T(a);0===t.data.code?(N.value=t.data.data.list||[],K.value=t.data.data.total||0,N.value.forEach(a=>{a.publishTime&&(a.publishTime=S(a.publishTime)),a.lastReply&&(a.lastReply=S(a.lastReply))})):w.error(t.data.msg||"获取发帖记录失败")}catch(t){w.error("获取发帖记录失败")}finally{Q.value=!1}},X=a=>{O.push(`/post/${a}`)},Y=a=>{U.value=a,W()},Z=a=>{q.value=a,U.value=1,W()},aa=()=>{O.push("/publish-post")},ta=a=>({team:"打球组队",notice:"赛事讨论",help:"求助问答",exp:"经验交流"}[a]||"其他");return s(()=>{W()}),(a,t)=>{var s,C;const M=r,S=u,T=f,O=g,sa=j,ea=z,la=k,ia=v;return A(),e("div",P,[t[3]||(t[3]=l("h2",null,"我的发帖",-1)),l("div",V,[n(R).token?(A(),e("div",B,[o(M,{src:(null==(s=n(R).userinfo)?void 0:s.avatar)||"https://tse1-mm.cn.bing.net/th/id/OIP-C.gaAkkFf8LStn-oc4l8iM0wAAAA?w=160&h=180&c=7&r=0&o=5&dpr=1.5&pid=1.7"},null,8,["src"]),l("span",J,p((null==(C=n(R).userinfo)?void 0:C.username)||"羽球爱好者"),1),l("div",L,[l("div",$,[t[1]||(t[1]=c("发帖数量：",-1)),l("span",null,p(K.value),1)])])])):i("",!0),o(S,{type:"primary",onClick:aa},{default:d(()=>[...t[2]||(t[2]=[c("发布新帖",-1)])]),l:1})]),l("div",D,[m((A(),y(ea,{data:N.value,style:{width:"100%"},"empty-text":"暂无发帖记录"},{default:d(()=>[o(O,{prop:"title",label:"帖子标题","min-width":"300"},{default:d(a=>[l("div",{class:"post-title",onClick:t=>X(a.row.id)},[a.row.isTop?(A(),y(T,{key:0,class:"top-icon"},{default:d(()=>[o(n(h))]),l:1})):i("",!0),c(" "+p(a.row.title),1)],8,E)]),l:1}),o(O,{prop:"categoryCode",label:"分类",width:"120"},{default:d(a=>{return[o(sa,{type:(t=a.row.categoryCode,{team:"success",notice:"primary",help:"warning",exp:"info"}[t]||"default")},{default:d(()=>[c(p(ta(a.row.categoryCode)),1)]),l:2},1032,["type"])];var t}),l:1}),o(O,{prop:"publishTime",label:"发布时间",width:"180"}),o(O,{label:"回复/查看",width:"120"},{default:d(a=>[l("div",F,[l("div",null,p(a.row.replyCount||0)+" 回复",1),l("div",null,p(a.row.views||0)+" 查看",1)])]),l:1}),o(O,{label:"操作",width:"150"},{default:d(a=>[l("div",G,[o(S,{type:"primary",icon:n(_),circle:"",size:"small",onClick:t=>X(a.row.id),title:"查看详情"},null,8,["icon","onClick"]),o(S,{type:"danger",icon:n(b),circle:"",size:"small",onClick:t=>{return s=a.row,void x.confirm(`确定要删除帖子"${s.title}"吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await I(s.id),w.success("帖子删除成功"),W()}catch(a){w.error("删除帖子失败")}}).catch(()=>{});var s},title:"删除帖子"},null,8,["icon","onClick"])])]),l:1})]),l:1},8,["data"])),[[ia,Q.value]]),l("div",H,[o(la,{modelValue:U.value,"onUpdate:modelValue":t[0]||(t[0]=a=>U.value=a),"page-size":q.value,total:K.value,"page-sizes":[5,10,20,50],layout:"total, sizes, prev, pager, next",onSizeChange:Z,onCurrentChange:Y},null,8,["modelValue","page-size","total"])])])])}}},[["__scopeId","data-v-b4ba7672"]]);export{O as default};
