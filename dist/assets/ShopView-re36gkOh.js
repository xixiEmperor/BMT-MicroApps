import{a,c as e}from"./index-BuScbc3L.js";/* empty css                     *//* empty css               */import"./el-tooltip-l0sNRNKZ.js";/* empty css                     */import{g as t,a as s,b as r}from"./shop-cKho_Rxx.js";import{_ as l}from"./_plugin-vue_export-helper-CTKw_zaB.js";import{r as o,q as c,N as i,K as d,B as n,A as u,_ as p,Y as m,a6 as g,a7 as y,Z as v,a5 as f,aj as _,z as h,y as C,V as b,a as w,d as k,w as F,a3 as I,M as j,at as S,af as A,ae as E,au as x,a8 as z,O as N,aw as B,ag as D,ay as M,ah as V,ai as $,E as L,az as P,aa as T,al as U,am as J,ap as K,I as O,a2 as W,aA as q,a0 as H}from"./element-plus-D8DMz00a.js";/* empty css                   *//* empty css                      *//* empty css                  *//* empty css                 *//* empty css                 *//* empty css               *//* empty css                *//* empty css                     *//* empty css                         */const Y={class:"category-list"},Z={class:"mobile-categories"},G={class:"category-tags"},Q=l({__name:"CategoryList",emits:["category-selected"],setup(a,{emit:e}){const s=o([]),r=o("all"),handleCategorySelect=a=>{r.value=a,l("category-selected",a)},l=e;return c(()=>{(async()=>{const a=await t();s.value=a.data.data})()}),(a,e)=>{const t=p,l=v,o=_;return h(),i("div",Y,[e[3]||(e[3]=d("h2",null,"商品分类",-1)),n(l,{class:"category-menu desktop-menu","default-active":r.value,onSelect:handleCategorySelect},{default:u(()=>[n(t,{index:"all"},{default:u(()=>[...e[1]||(e[1]=[m(" 全部商品 ",-1)])]),_:1}),(h(!0),i(g,null,y(s.value,a=>(h(),C(t,{key:a.id,index:a.id.toString()},{default:u(()=>[m(b(a.name),1)]),_:2},1032,["index"]))),128))]),_:1},8,["default-active"]),d("div",Z,[d("div",G,[n(o,{class:f(["category-tag",{active:"all"===r.value}]),onClick:e[0]||(e[0]=a=>handleCategorySelect("all")),effect:"plain"},{default:u(()=>[...e[2]||(e[2]=[m(" 全部商品 ",-1)])]),_:1},8,["class"]),(h(!0),i(g,null,y(s.value,a=>(h(),C(o,{key:a.id,class:f(["category-tag",{active:r.value===a.id.toString()}]),onClick:e=>handleCategorySelect(a.id.toString()),effect:"plain"},{default:u(()=>[m(b(a.name),1)]),_:2},1032,["class","onClick"]))),128))])])])}}},[["__scopeId","data-v-030a4f76"]]),R={class:"product-list"},X={class:"filter-panel"},aa={class:"filter-row"},ea={class:"button-row"},ta={class:"product-grid"},sa=["src"],ra={class:"product-info"},la={class:"product-name"},oa={class:"product-subtitle"},ca={class:"product-price-row"},ia={class:"product-price"},da={class:"product-sales"},na={key:0,class:"pagination-container"},ua=l({__name:"ProductList",props:{categoryId:{type:[String,Number],default:"all"}},setup(e){const t=e,r=a(),l=o(!1),c=o([]),p=w({keyword:"",orderBy:"",pageNum:1,pageSize:8,categoryId:t.categoryId}),v=w({pageNum:1,pageSize:8,total:0}),f=k(()=>window.innerWidth<=768?"prev, pager, next":"total, sizes, prev, pager, next, jumper"),fetchProducts=async()=>{l.value=!0;try{const a=await s(p);0===a.data.code?(c.value=a.data.data.list,v.pageNum=a.data.data.pageNum,v.pageSize=a.data.data.pageSize,v.total=a.data.data.total):L.error("获取商品列表失败")}catch(a){L.error("获取商品列表失败")}finally{l.value=!1}};F(()=>t.categoryId,a=>{p.categoryId=a,p.pageNum=1,fetchProducts()},{immediate:!0});const handleSearch=()=>{p.pageNum=1,fetchProducts()},resetSearch=()=>{p.keyword="",p.orderBy="",p.pageNum=1,fetchProducts()},handleSizeChange=a=>{p.pageSize=a,fetchProducts()},handleCurrentChange=a=>{p.pageNum=a,fetchProducts()};return(a,e)=>{const t=E,s=A,o=S,_=x,w=N,k=B,F=T,L=P,U=M,J=V,K=$,O=D;return h(),i("div",R,[d("div",X,[n(k,{inline:!0,class:"filter-form"},{default:u(()=>[d("div",aa,[n(o,{label:"排序方式",class:"sort-item"},{default:u(()=>[n(s,{modelValue:p.orderBy,"onUpdate:modelValue":e[0]||(e[0]=a=>p.orderBy=a),placeholder:"请选择"},{default:u(()=>[n(t,{label:"默认排序",value:""}),n(t,{label:"价格升序",value:"price_asc"}),n(t,{label:"价格降序",value:"price_desc"}),n(t,{label:"销量降序",value:"sales_desc"})]),_:1},8,["modelValue"])]),_:1}),n(o,{label:"关键词",class:"search-item"},{default:u(()=>[n(_,{modelValue:p.keyword,"onUpdate:modelValue":e[1]||(e[1]=a=>p.keyword=a),placeholder:"请输入关键词",onKeyup:z(handleSearch,["enter"])},null,8,["modelValue"])]),_:1})]),d("div",ea,[n(o,null,{default:u(()=>[n(w,{type:"primary",onClick:handleSearch},{default:u(()=>[...e[2]||(e[2]=[m("搜索",-1)])]),_:1}),n(w,{onClick:resetSearch},{default:u(()=>[...e[3]||(e[3]=[m("重置",-1)])]),_:1})]),_:1})])]),_:1})]),I((h(),i("div",ta,[n(U,{gutter:20},{default:u(()=>[(h(!0),i(g,null,y(c.value,a=>(h(),C(L,{xs:12,sm:12,md:8,lg:6,key:a.id},{default:u(()=>[n(F,{class:"product-card",onClick:e=>{return t=a.id,void r.push(`/product/${t}`);var t}},{default:u(()=>[d("img",{src:a.mainImage,class:"product-image"},null,8,sa),d("div",ra,[d("h3",la,b(a.name),1),d("p",oa,b(a.subtitle),1),d("div",ca,[d("span",ia,"¥"+b(a.price.toFixed(2)),1),d("span",da,"销量: "+b(a.sales),1)])])]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1}),0!==c.value.length||l.value?j("",!0):(h(),C(J,{key:0,description:"暂无商品"}))])),[[O,l.value]]),v.total>0?(h(),i("div",na,[n(K,{background:"",onSizeChange:handleSizeChange,onCurrentChange:handleCurrentChange,"current-page":v.pageNum,"page-sizes":[8,4,6,10,12],"page-size":v.pageSize,layout:f.value,total:v.total},null,8,["current-page","page-size","layout","total"])])):j("",!0)])}}},[["__scopeId","data-v-e932d64b"]]),pa={class:"product-carousel"},ma={class:"content-left"},ga={class:"carousel-title"},ya={class:"carousel-subtitle"},va={class:"content-right"},fa=["src","alt"],_a=l({__name:"ProductCarousel",setup(t){const s=a(),l=o([]);o([]);const p=[{primary:"#FF6B6B",secondary:"#4ECDC4"},{primary:"#845EC2",secondary:"#FF8066"},{primary:"#FFD93D",secondary:"#6BCF7F"},{primary:"#FF8E9B",secondary:"#C7CEEA"},{primary:"#A8E6CF",secondary:"#FFEAA7"},{primary:"#74B9FF",secondary:"#FD79A8"},{primary:"#FDCB6E",secondary:"#6C5CE7"},{primary:"#55A3FF",secondary:"#FEA47F"},{primary:"#26DE81",secondary:"#FC7C7C"},{primary:"#A29BFE",secondary:"#FDA085"}],getColorIndexFromString=a=>{let e=0;for(let t=0;t<a.length;t++){e=(e<<5)-e+a.charCodeAt(t),e&=e}return Math.abs(e)%p.length},getThemeColorViaProxy=async()=>{try{const a=l.value.map(async(a,t)=>{try{const t=await e.post("/api/image/extract-color",{imageUrl:a.mainImage});if(0===t.data.code){const e=t.data.data.color,s=t.data.data.source,r=`linear-gradient(135deg, ${e}CC, ${adjustColorBrightness(e,-30)}DD)`;return a.bgColor=r,a.colorSource="oss"===s?"阿里云OSS":"java"===s?"Java处理":s,{color:e,source:s,success:!0}}throw new Error(t.data.msg||"后端返回错误")}catch(s){const e=getColorIndexFromString(a.productName+a.productId),t=p[e],r=`linear-gradient(135deg, ${t.primary}CC, ${t.secondary}AA)`;return a.bgColor=r,a.colorSource="预设方案",{color:t.primary,source:"fallback",success:!1,error:s.message}}}),t=await Promise.all(a);t.filter(a=>a.success).length,t.filter(a=>!a.success).length}catch(a){await(async()=>{try{l.value.forEach((a,e)=>{const t=getColorIndexFromString(a.productName+a.productId),s=p[t],r=`linear-gradient(135deg, ${s.primary}CC, ${s.secondary}AA)`;a.bgColor=r})}catch(a){}})()}},adjustColorBrightness=(a,e)=>{const t=a.replace("#",""),s=parseInt(t,16);return"#"+((1<<24)+(Math.max(0,Math.min(255,(s>>16)+e))<<16)+(Math.max(0,Math.min(255,(s>>8&255)+e))<<8)+Math.max(0,Math.min(255,(255&s)+e))).toString(16).slice(1)};return c(async()=>{await(async()=>{try{const a=await r();0===a.data.code?l.value=a.data.data:L.error(a.data.msg)}catch(a){}})(),await getThemeColorViaProxy()}),(a,e)=>{const t=N,r=J,o=U;return h(),i("div",pa,[n(o,{interval:4e3,type:"card",height:"280px","indicator-position":"outside",arrow:"never",class:"carousel-container"},{default:u(()=>[(h(!0),i(g,null,y(l.value,a=>(h(),C(r,{key:a.productId,class:"carousel-item"},{default:u(()=>[d("div",{class:"carousel-content",style:K({background:a.bgColor||"linear-gradient(135deg, #6366f1AA, #4f46e5DD)"})},[d("div",ma,[d("h3",ga,b(a.productName),1),d("p",ya,b(a.subtitle),1),n(t,{type:"primary",size:"large",class:"carousel-button",onClick:e=>{return t=a.productId,void s.push(`/product/${t}`);var t}},{default:u(()=>[...e[0]||(e[0]=[m(" 立即购买 ",-1)])]),_:1},8,["onClick"])]),d("div",va,[d("img",{src:a.mainImage,alt:a.productName,class:"carousel-image"},null,8,fa)])],4)]),_:2},1024))),128))]),_:1})])}}},[["__scopeId","data-v-805635c4"]]),ha={class:"shop-container"},Ca={class:"category-section"},ba={key:1,class:"mobile-layout"},wa={class:"mobile-category"},ka={class:"mobile-products"},Fa=l({__name:"ShopView",setup(a){const e=o("all"),t=o(!1),checkScreenSize=()=>{t.value=window.innerWidth<=768},s=((a,e)=>{let t;return function(...s){clearTimeout(t),t=setTimeout(()=>{clearTimeout(t),a(...s)},e)}})(checkScreenSize,150),handleCategoryChange=a=>{e.value=a};return c(()=>{checkScreenSize(),window.addEventListener("resize",s)}),O(()=>{window.removeEventListener("resize",s)}),(a,s)=>{const r=q,l=H,o=W;return h(),i("div",ha,[s[0]||(s[0]=d("div",{class:"page-header"},[d("h1",{class:"page-title"},"羽体商城"),d("p",{class:"page-subtitle"},"专业羽毛球装备，助力你的运动表现")],-1)),n(_a),t.value?j("",!0):(h(),C(o,{key:0,class:"desktop-layout"},{default:u(()=>[n(r,{width:"240px",class:"sidebar"},{default:u(()=>[d("div",Ca,[n(Q,{onCategorySelected:handleCategoryChange})])]),_:1}),n(l,{class:"main-content"},{default:u(()=>[n(ua,{categoryId:e.value},null,8,["categoryId"])]),_:1})]),_:1})),t.value?(h(),i("div",ba,[d("div",wa,[n(Q,{onCategorySelected:handleCategoryChange})]),d("div",ka,[n(ua,{categoryId:e.value},null,8,["categoryId"])])])):j("",!0)])}}},[["__scopeId","data-v-973c1984"]]);export{Fa as default};
