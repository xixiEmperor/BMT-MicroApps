var $=Object.defineProperty;var j=(e,r,t)=>r in e?$(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t;var k=(e,r,t)=>j(e,typeof r!="symbol"?r+"":r,t);import{aj as z,b1 as U,b as L,u as q,E as M,Y as A,r as O,L as V,q as S,i as b,l as x,P as B,Q as K,M as F,N as J,T}from"./index-CBwtJ5i4.js";import{_ as G}from"./_plugin-vue_export-helper-CfPbstfH.js";function Q(e){return new Promise(r=>setTimeout(r,e))}function W(e={}){const{retries:r=3,baseMs:t=1e3,capMs:s=3e4,strategy:y="exponential",jitter:l=!0,shouldRetry:u}=e,m=i=>{let p;y==="fixed"?p=t:y==="linear"?p=t*(i+1):p=t*Math.pow(2,i);const n=Math.min(p,s);return l?Math.floor(Math.random()*n):n},a=(i,p)=>p<r;return async function(p){const n=r+1;let h;for(let o=0;o<n;o++)try{return await p()}catch(d){h=d;const f=(u??a)(d,o),E=o>=r;if(!f||E)throw d;const c=m(o);await Q(c)}throw h}}async function Y(e,r={}){return W(r)(e)}var _=class v extends Error{constructor(t,s,y,l){super(s);k(this,"type");k(this,"status");k(this,"data");this.name="HttpError",this.type=t,this.status=y,this.data=l}static network(t){return new v("Network",t)}static timeout(t){return new v("Timeout",t)}static http(t,s,y){return new v("Http",s,t,y)}static validation(t,s){return new v("Validation",t,void 0,s)}static serviceUnavailable(t){return new v("ServiceUnavailable",t)}},R=null,D=[],I=!0,H=new Map;function P(e){return e===null||typeof e!="object"?JSON.stringify(e):Array.isArray(e)?`[${e.map(P).join(",")}]`:`{${Object.entries(e).sort(([t],[s])=>t<s?-1:t>s?1:0).map(([t,s])=>`${JSON.stringify(t)}:${P(s)}`).join(",")}}`}function X(e,r,t,s){const y=t!=null&&t.params?P(t.params):"",l=s!==void 0?P(s):"";return`${e.toUpperCase()} ${r}?${y} body:${l}`}async function Z(e){let r=e;for(const t of D)t.onRequest&&(r=await t.onRequest(r));return r}async function tt(e){let r=e;for(const t of D)t.onResponse&&(r=await t.onResponse(r));return r&&"data"in r?r.data:r}async function et(e){for(const r of D)r.onError&&await r.onError(e);throw e}function rt(e){const{baseURL:r,plugins:t=[],retry:s,requestDedup:y=!0,timeout:l=1e4}=e;R=z.create({baseURL:r,timeout:l}),R.interceptors.request.use(a=>(a.__startTime=Date.now(),a)),R.interceptors.response.use(a=>{const i=a.config.__startTime;return a.duration=typeof i=="number"?Date.now()-i:0,a},a=>{if(a&&a.config){const i=a.config.__startTime;a.response&&(a.response.duration=typeof i=="number"?Date.now()-i:0)}return Promise.reject(a)}),D=t,I=y;const u=async(a,i,p,n)=>{if(!R)throw new Error("Axios instance not initialized");const h={...n??{},method:a,url:i,data:p},o=await Z(h),d=async()=>{try{const c=await R.request(o);return await tt(c)}catch(c){let w=c;U(c)&&(c.code==="ECONNABORTED"?w=_.timeout(c.message):c.response?w=_.http(c.response.status,c.message,c.response.data):c.request&&(w=_.network(c.message||"Network Error")));try{await et(w)}catch{}throw w}},f=()=>Y(d,{...s??{},...(n==null?void 0:n.retryConfig)??{}});if(((n==null?void 0:n.enableDedup)??!0)&&I&&o.method&&o.url){const c=X(o.method,o.url,o,o.data);if(H.has(c))return H.get(c);const w=f().finally(()=>H.delete(c));return H.set(c,w),w}return f()},m={get:(a,i)=>u("GET",a,void 0,i),delete:(a,i)=>u("DELETE",a,void 0,i),head:(a,i)=>u("HEAD",a,void 0,i),options:(a,i)=>u("OPTIONS",a,void 0,i),post:(a,i,p)=>u("POST",a,i,p),put:(a,i,p)=>u("PUT",a,i,p),patch:(a,i,p)=>u("PATCH",a,i,p)};return g.get=m.get,g.post=m.post,g.put=m.put,g.delete=m.delete,g.patch=m.patch,g.head=m.head,g.options=m.options,m}var g={get:()=>{throw new Error("HTTP client not initialized. Call initHttp() first.")},post:()=>{throw new Error("HTTP client not initialized. Call initHttp() first.")},put:()=>{throw new Error("HTTP client not initialized. Call initHttp() first.")},delete:()=>{throw new Error("HTTP client not initialized. Call initHttp() first.")},patch:()=>{throw new Error("HTTP client not initialized. Call initHttp() first.")},head:()=>{throw new Error("HTTP client not initialized. Call initHttp() first.")},options:()=>{throw new Error("HTTP client not initialized. Call initHttp() first.")}};function nt(e={}){const{getToken:r=()=>null,refreshToken:t,onTokenExpired:s,tokenHeader:y="Authorization",tokenPrefix:l="Bearer "}=e;return{name:"auth",async onRequest(u){const m=await r();return m&&(u.headers=u.headers??{},u.headers[y]=`${l}${m}`),u},async onError(u){if(u&&u.status===401)try{await(s==null?void 0:s())}catch{}throw u}}}const N=L();let C=!1;rt({baseURL:void 0,timeout:1e4,plugins:[nt({getToken:()=>localStorage.getItem("token"),onTokenExpired:()=>{if(C)return;C=!0,q().userinfo.token?(M.warning("登录已过期，请重新登录"),q().logout()):M.warning("请先登录");const r=N.currentRoute.value.fullPath;r!=="/login"&&N.push({path:"/login",query:{redirect:r}}),setTimeout(()=>{C=!1},1e3)}})]});const pt=e=>A({url:"/api/auth/send-code",method:"post",data:e}),dt=e=>A({url:"/api/auth/register",method:"post",data:e}),ft=e=>g.post("/api/auth/login",e),ht=e=>A({url:"/api/auth/reset-password",method:"post",data:e}),at={class:"verification-code-input"},st={class:"code-inputs"},ot=["onUpdate:modelValue","onInput","onKeydown"],it={__name:"VerificationCodeInput",props:{modelValue:{type:String,default:""},length:{type:Number,default:6}},emits:["update:modelValue"],setup(e,{expose:r,emit:t}){const s=e,y=t,l=O(Array(s.length).fill("")),u=O([]),m=(n,h)=>{n&&(u.value[h]=n)};V(()=>s.modelValue,n=>{n!==l.value.join("")&&(l.value=n.split("").concat(Array(s.length).fill("")).slice(0,s.length))},{immediate:!0}),V(l,n=>{const h=n.join("");y("update:modelValue",h)},{deep:!0});const a=(n,h)=>{const o=h.replace(/\D/g,"");l.value[n]=o,o&&n<s.length-1&&T(()=>{var d;(d=u.value[n+1])==null||d.focus()})},i=(n,h)=>{h.key==="Backspace"&&!l.value[n]&&n>0?T(()=>{var o;(o=u.value[n-1])==null||o.focus()}):h.key==="ArrowLeft"&&n>0?T(()=>{var o;(o=u.value[n-1])==null||o.focus()}):h.key==="ArrowRight"&&n<s.length-1&&T(()=>{var o;(o=u.value[n+1])==null||o.focus()})},p=n=>{n.preventDefault();const o=n.clipboardData.getData("text").replace(/\D/g,"").split("").slice(0,s.length);o.forEach((f,E)=>{E<s.length&&(l.value[E]=f)});const d=Math.min(o.length-1,s.length-1);T(()=>{var f;(f=u.value[d])==null||f.focus()})};return r({focus:()=>{var n;(n=u.value[0])==null||n.focus()},clear:()=>{var n;l.value=Array(s.length).fill(""),(n=u.value[0])==null||n.focus()}}),(n,h)=>(b(),S("div",at,[x("div",st,[(b(!0),S(B,null,K(l.value,(o,d)=>F((b(),S("input",{key:d,"onUpdate:modelValue":f=>l.value[d]=f,ref_for:!0,ref:f=>m(f,d),maxlength:"1",class:"code-digit",onInput:f=>a(d,f.target.value),onKeydown:f=>i(d,f),onPaste:p,type:"text",inputmode:"numeric",pattern:"[0-9]*"},null,40,ot)),[[J,l.value[d]]])),128))])]))}},mt=G(it,[["__scopeId","data-v-d1422850"]]);export{mt as V,pt as a,dt as b,ft as c,ht as d};
