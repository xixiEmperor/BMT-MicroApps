import{r as s,o as a,an as e,E as l,a as t,l as i,h as c,g as n,w as o,p as d,k as r,x as u,m as p,ai as f,J as v,j as m,aE as y,A as _,aF as k,aG as g,aH as b}from"./index-RXELqIC3.js";/* empty css                         */import{_ as h}from"./_plugin-vue_export-helper-CRLhVpGU.js";import{g as C,q as w}from"./pay-CUktMawW.js";const j={class:"payment-result-container"},z={key:0,class:"result-content success"},x={class:"result-icon"},N={class:"order-info"},S={class:"info-item"},A={class:"value"},E={key:0,class:"info-item"},J={class:"value price"},L={key:1,class:"info-item"},q={class:"value"},D={class:"action-buttons"},F={key:1,class:"result-content failed"},G={class:"result-icon"},H={class:"order-info"},I={class:"info-item"},M={class:"value"},O={class:"info-item"},P={class:"value"},R={class:"action-buttons"},T={key:2,class:"result-content timeout"},V={class:"result-icon"},$={class:"order-info"},B={class:"info-item"},K={class:"value"},Q={class:"action-buttons"},U={key:3,class:"result-content cancelled"},W={class:"result-icon"},X={class:"order-info"},Y={class:"info-item"},Z={class:"value"},ss={class:"action-buttons"},as={key:4,class:"result-content loading"},es=h({l:"PaymentResultView",setup(h){const es=t(),ls=e(),ts=s(""),is=s(""),cs=s(null),ns=s(""),os=()=>{es.push(`/order-detail/${is.value}`)},ds=()=>{es.push("/shop")},rs=()=>{var s;const a={orderNo:is.value,amount:(null==(s=cs.value)?void 0:s.totalAmount)||0,businessType:"MALL"};localStorage.setItem("payment_info",JSON.stringify(a)),es.push("/payment")},us=s=>{if(!s)return"";return new Date(s).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})};return a(async()=>{if(is.value=ls.query.orderNo,ts.value=ls.query.status||"",!is.value)return l.error("订单号不存在"),void es.push("/orders");await(async()=>{try{const s=await C(is.value);0===s.data.code&&(cs.value=s.data.data)}catch(s){}})(),ts.value&&"unknown"!==ts.value||await(async()=>{try{const s=await w(is.value);if(0===s.data.code){const a=s.data.data.status;ts.value=1===a?"success":ls.query.status||"failed"}else ts.value="failed",ns.value=s.message}catch(s){ts.value="failed",ns.value="网络异常，请稍后重试"}})(),localStorage.removeItem("payment_info")}),(s,a)=>{var e;const l=d,t=p,h=f;return v(),i("div",j,["success"===ts.value?(v(),i("div",z,[c("div",x,[n(l,{class:"success-icon",size:"80"},{default:o(()=>[n(m(y))]),t:1})]),a[5]||(a[5]=c("h2",{class:"result-title"},"支付成功",-1)),a[6]||(a[6]=c("p",{class:"result-message"},"恭喜您，订单支付成功！",-1)),c("div",N,[c("div",S,[a[0]||(a[0]=c("span",{class:"label"},"订单号：",-1)),c("span",A,u(is.value),1)]),cs.value?(v(),i("div",E,[a[1]||(a[1]=c("span",{class:"label"},"支付金额：",-1)),c("span",J,"¥"+u(null==(e=cs.value.totalAmount)?void 0:e.toFixed(2)),1)])):r("",!0),cs.value?(v(),i("div",L,[a[2]||(a[2]=c("span",{class:"label"},"支付时间：",-1)),c("span",q,u(us(cs.value.payTime)),1)])):r("",!0)]),c("div",D,[n(t,{type:"primary",onClick:os},{default:o(()=>[...a[3]||(a[3]=[_("查看订单详情",-1)])]),t:1}),n(t,{onClick:ds},{default:o(()=>[...a[4]||(a[4]=[_("继续购物",-1)])]),t:1})])])):"failed"===ts.value?(v(),i("div",F,[c("div",G,[n(l,{class:"failed-icon",size:"80"},{default:o(()=>[n(m(k))]),t:1})]),a[12]||(a[12]=c("h2",{class:"result-title"},"支付失败",-1)),a[13]||(a[13]=c("p",{class:"result-message"},"很抱歉，您的订单支付失败，请重试",-1)),c("div",H,[c("div",I,[a[7]||(a[7]=c("span",{class:"label"},"订单号：",-1)),c("span",M,u(is.value),1)]),c("div",O,[a[8]||(a[8]=c("span",{class:"label"},"失败原因：",-1)),c("span",P,u(ns.value||"支付过程中出现异常"),1)])]),c("div",R,[n(t,{type:"primary",onClick:rs},{default:o(()=>[...a[9]||(a[9]=[_("重新支付",-1)])]),t:1}),n(t,{onClick:os},{default:o(()=>[...a[10]||(a[10]=[_("查看订单详情",-1)])]),t:1}),n(t,{onClick:ds},{default:o(()=>[...a[11]||(a[11]=[_("继续购物",-1)])]),t:1})])])):"timeout"===ts.value?(v(),i("div",T,[c("div",V,[n(l,{class:"timeout-icon",size:"80"},{default:o(()=>[n(m(g))]),t:1})]),a[19]||(a[19]=c("h2",{class:"result-title"},"支付超时",-1)),a[20]||(a[20]=c("p",{class:"result-message"},"支付时间已超时，请重新发起支付",-1)),c("div",$,[c("div",B,[a[14]||(a[14]=c("span",{class:"label"},"订单号：",-1)),c("span",K,u(is.value),1)]),a[15]||(a[15]=c("div",{class:"info-item"},[c("span",{class:"label"},"超时时间："),c("span",{class:"value"},"10分钟")],-1))]),c("div",Q,[n(t,{type:"primary",onClick:rs},{default:o(()=>[...a[16]||(a[16]=[_("重新支付",-1)])]),t:1}),n(t,{onClick:os},{default:o(()=>[...a[17]||(a[17]=[_("查看订单详情",-1)])]),t:1}),n(t,{onClick:ds},{default:o(()=>[...a[18]||(a[18]=[_("继续购物",-1)])]),t:1})])])):"cancelled"===ts.value?(v(),i("div",U,[c("div",W,[n(l,{class:"cancelled-icon",size:"80"},{default:o(()=>[n(m(b))]),t:1})]),a[25]||(a[25]=c("h2",{class:"result-title"},"支付已取消",-1)),a[26]||(a[26]=c("p",{class:"result-message"},"您已取消本次支付，可以重新发起支付",-1)),c("div",X,[c("div",Y,[a[21]||(a[21]=c("span",{class:"label"},"订单号：",-1)),c("span",Z,u(is.value),1)])]),c("div",ss,[n(t,{type:"primary",onClick:rs},{default:o(()=>[...a[22]||(a[22]=[_("重新支付",-1)])]),t:1}),n(t,{onClick:os},{default:o(()=>[...a[23]||(a[23]=[_("查看订单详情",-1)])]),t:1}),n(t,{onClick:ds},{default:o(()=>[...a[24]||(a[24]=[_("继续购物",-1)])]),t:1})])])):(v(),i("div",as,[n(h,{rows:5,animated:""})]))])}}},[["__scopeId","data-v-ae46554b"]]);export{es as default};
